
<html>
<head>

  <meta http-equiv="Content-Type" content="text/html; charset=US-ASCII" />
  <title>ntapi.h</title>

  <link rel="stylesheet" href="../style.css"/>
  <script src="../jquery-3.5.1.min.js"></script>
</head>
<body>

<pre><code class = "cpp">
<a name="ln1">// This is a personal academic project. Dear PVS-Studio, please check it.</a>
<a name="ln2"> </a>
<a name="ln3">// PVS-Studio Static Code Analyzer for C, C++, C#, and Java: http://www.viva64.com</a>
<a name="ln4"> </a>
<a name="ln5">#pragma once</a>
<a name="ln6">#include &lt;windows.h&gt;</a>
<a name="ln7">#include &lt;stdio.h&gt;</a>
<a name="ln8"> </a>
<a name="ln9">// Typedefs</a>
<a name="ln10">typedef LONG        NTSTATUS;</a>
<a name="ln11">typedef LONG        KPRIORITY;</a>
<a name="ln12"> </a>
<a name="ln13">// status codes</a>
<a name="ln14">#define STATUS_SUCCESS ((NTSTATUS)0x00000000L)</a>
<a name="ln15">#define STATUS_NOT_SUPPORTED ((NTSTATUS)0xC00000BBL)</a>
<a name="ln16"> </a>
<a name="ln17">// Structs</a>
<a name="ln18">typedef struct _UNICODE_STR</a>
<a name="ln19">{</a>
<a name="ln20">    USHORT Length;</a>
<a name="ln21">    USHORT MaximumLength;</a>
<a name="ln22">    PWSTR pBuffer;</a>
<a name="ln23">} UNICODE_STR, * PUNICODE_STR;</a>
<a name="ln24"> </a>
<a name="ln25">// WinDbg&gt; dt -v ntdll!_LDR_DATA_TABLE_ENTRY</a>
<a name="ln26">//__declspec( align(8) ) </a>
<a name="ln27">typedef struct _LDR_DATA_TABLE_ENTRY</a>
<a name="ln28">{</a>
<a name="ln29">    //LIST_ENTRY InLoadOrderLinks; // As we search from PPEB_LDR_DATA-&gt;InMemoryOrderModuleList we dont use the first entry.</a>
<a name="ln30">    LIST_ENTRY InMemoryOrderModuleList;</a>
<a name="ln31">    LIST_ENTRY InInitializationOrderModuleList;</a>
<a name="ln32">    PVOID DllBase;</a>
<a name="ln33">    PVOID EntryPoint;</a>
<a name="ln34">    ULONG SizeOfImage;</a>
<a name="ln35">    UNICODE_STR FullDllName;</a>
<a name="ln36">    UNICODE_STR BaseDllName;</a>
<a name="ln37">    ULONG Flags;</a>
<a name="ln38">    SHORT LoadCount;</a>
<a name="ln39">    SHORT TlsIndex;</a>
<a name="ln40">    LIST_ENTRY HashTableEntry;</a>
<a name="ln41">    ULONG TimeDateStamp;</a>
<a name="ln42">} LDR_DATA_TABLE_ENTRY, * PLDR_DATA_TABLE_ENTRY;</a>
<a name="ln43"> </a>
<a name="ln44">// WinDbg&gt; dt -v ntdll!_PEB_LDR_DATA</a>
<a name="ln45">typedef struct _PEB_LDR_DATA //, 7 elements, 0x28 bytes</a>
<a name="ln46">{</a>
<a name="ln47">    DWORD dwLength;</a>
<a name="ln48">    DWORD dwInitialized;</a>
<a name="ln49">    LPVOID lpSsHandle;</a>
<a name="ln50">    LIST_ENTRY InLoadOrderModuleList;</a>
<a name="ln51">    LIST_ENTRY InMemoryOrderModuleList;</a>
<a name="ln52">    LIST_ENTRY InInitializationOrderModuleList;</a>
<a name="ln53">    LPVOID lpEntryInProgress;</a>
<a name="ln54">} PEB_LDR_DATA, * PPEB_LDR_DATA;</a>
<a name="ln55"> </a>
<a name="ln56">// WinDbg&gt; dt -v ntdll!_PEB_FREE_BLOCK</a>
<a name="ln57">typedef struct _PEB_FREE_BLOCK // 2 elements, 0x8 bytes</a>
<a name="ln58">{</a>
<a name="ln59">    struct _PEB_FREE_BLOCK* pNext;</a>
<a name="ln60">    DWORD dwSize;</a>
<a name="ln61">} PEB_FREE_BLOCK, * PPEB_FREE_BLOCK;</a>
<a name="ln62"> </a>
<a name="ln63">// struct _PEB is defined in Winternl.h but it is incomplete</a>
<a name="ln64">// WinDbg&gt; dt -v ntdll!_PEB</a>
<a name="ln65">typedef struct __PEB // 65 elements, 0x210 bytes</a>
<a name="ln66">{</a>
<a name="ln67">    BYTE bInheritedAddressSpace;</a>
<a name="ln68">    BYTE bReadImageFileExecOptions;</a>
<a name="ln69">    BYTE bBeingDebugged;</a>
<a name="ln70">    BYTE bSpareBool;</a>
<a name="ln71">    LPVOID lpMutant;</a>
<a name="ln72">    LPVOID lpImageBaseAddress;</a>
<a name="ln73">    PPEB_LDR_DATA pLdr;</a>
<a name="ln74">    LPVOID lpProcessParameters;</a>
<a name="ln75">    LPVOID lpSubSystemData;</a>
<a name="ln76">    LPVOID lpProcessHeap;</a>
<a name="ln77">    PRTL_CRITICAL_SECTION pFastPebLock;</a>
<a name="ln78">    LPVOID lpFastPebLockRoutine;</a>
<a name="ln79">    LPVOID lpFastPebUnlockRoutine;</a>
<a name="ln80">    DWORD dwEnvironmentUpdateCount;</a>
<a name="ln81">    LPVOID lpKernelCallbackTable;</a>
<a name="ln82">    DWORD dwSystemReserved;</a>
<a name="ln83">    DWORD dwAtlThunkSListPtr32;</a>
<a name="ln84">    PPEB_FREE_BLOCK pFreeList;</a>
<a name="ln85">    DWORD dwTlsExpansionCounter;</a>
<a name="ln86">    LPVOID lpTlsBitmap;</a>
<a name="ln87">    DWORD dwTlsBitmapBits[2];</a>
<a name="ln88">    LPVOID lpReadOnlySharedMemoryBase;</a>
<a name="ln89">    LPVOID lpReadOnlySharedMemoryHeap;</a>
<a name="ln90">    LPVOID lpReadOnlyStaticServerData;</a>
<a name="ln91">    LPVOID lpAnsiCodePageData;</a>
<a name="ln92">    LPVOID lpOemCodePageData;</a>
<a name="ln93">    LPVOID lpUnicodeCaseTableData;</a>
<a name="ln94">    DWORD dwNumberOfProcessors;</a>
<a name="ln95">    DWORD dwNtGlobalFlag;</a>
<a name="ln96">    LARGE_INTEGER liCriticalSectionTimeout;</a>
<a name="ln97">    DWORD dwHeapSegmentReserve;</a>
<a name="ln98">    DWORD dwHeapSegmentCommit;</a>
<a name="ln99">    DWORD dwHeapDeCommitTotalFreeThreshold;</a>
<a name="ln100">    DWORD dwHeapDeCommitFreeBlockThreshold;</a>
<a name="ln101">    DWORD dwNumberOfHeaps;</a>
<a name="ln102">    DWORD dwMaximumNumberOfHeaps;</a>
<a name="ln103">    LPVOID lpProcessHeaps;</a>
<a name="ln104">    LPVOID lpGdiSharedHandleTable;</a>
<a name="ln105">    LPVOID lpProcessStarterHelper;</a>
<a name="ln106">    DWORD dwGdiDCAttributeList;</a>
<a name="ln107">    LPVOID lpLoaderLock;</a>
<a name="ln108">    DWORD dwOSMajorVersion;</a>
<a name="ln109">    DWORD dwOSMinorVersion;</a>
<a name="ln110">    WORD wOSBuildNumber;</a>
<a name="ln111">    WORD wOSCSDVersion;</a>
<a name="ln112">    DWORD dwOSPlatformId;</a>
<a name="ln113">    DWORD dwImageSubsystem;</a>
<a name="ln114">    DWORD dwImageSubsystemMajorVersion;</a>
<a name="ln115">    DWORD dwImageSubsystemMinorVersion;</a>
<a name="ln116">    DWORD dwImageProcessAffinityMask;</a>
<a name="ln117">    DWORD dwGdiHandleBuffer[34];</a>
<a name="ln118">    LPVOID lpPostProcessInitRoutine;</a>
<a name="ln119">    LPVOID lpTlsExpansionBitmap;</a>
<a name="ln120">    DWORD dwTlsExpansionBitmapBits[32];</a>
<a name="ln121">    DWORD dwSessionId;</a>
<a name="ln122">    ULARGE_INTEGER liAppCompatFlags;</a>
<a name="ln123">    ULARGE_INTEGER liAppCompatFlagsUser;</a>
<a name="ln124">    LPVOID lppShimData;</a>
<a name="ln125">    LPVOID lpAppCompatInfo;</a>
<a name="ln126">    UNICODE_STR usCSDVersion;</a>
<a name="ln127">    LPVOID lpActivationContextData;</a>
<a name="ln128">    LPVOID lpProcessAssemblyStorageMap;</a>
<a name="ln129">    LPVOID lpSystemDefaultActivationContextData;</a>
<a name="ln130">    LPVOID lpSystemAssemblyStorageMap;</a>
<a name="ln131">    DWORD dwMinimumStackCommit;</a>
<a name="ln132">} _PEB, * _PPEB;</a>
<a name="ln133">typedef enum _PROCESSINFOCLASS</a>
<a name="ln134">{</a>
<a name="ln135">    ProcessBasicInformation, // q: PROCESS_BASIC_INFORMATION, PROCESS_EXTENDED_BASIC_INFORMATION</a>
<a name="ln136">    ProcessQuotaLimits, // qs: QUOTA_LIMITS, QUOTA_LIMITS_EX</a>
<a name="ln137">    ProcessIoCounters, // q: IO_COUNTERS</a>
<a name="ln138">    ProcessVmCounters, // q: VM_COUNTERS, VM_COUNTERS_EX, VM_COUNTERS_EX2</a>
<a name="ln139">    ProcessTimes, // q: KERNEL_USER_TIMES</a>
<a name="ln140">    ProcessBasePriority, // s: KPRIORITY</a>
<a name="ln141">    ProcessRaisePriority, // s: ULONG</a>
<a name="ln142">    ProcessDebugPort, // q: HANDLE</a>
<a name="ln143">    ProcessExceptionPort, // s: PROCESS_EXCEPTION_PORT</a>
<a name="ln144">    ProcessAccessToken, // s: PROCESS_ACCESS_TOKEN</a>
<a name="ln145">    ProcessLdtInformation, // qs: PROCESS_LDT_INFORMATION // 10</a>
<a name="ln146">    ProcessLdtSize, // s: PROCESS_LDT_SIZE</a>
<a name="ln147">    ProcessDefaultHardErrorMode, // qs: ULONG</a>
<a name="ln148">    ProcessIoPortHandlers, // (kernel-mode only) // PROCESS_IO_PORT_HANDLER_INFORMATION</a>
<a name="ln149">    ProcessPooledUsageAndLimits, // q: POOLED_USAGE_AND_LIMITS</a>
<a name="ln150">    ProcessWorkingSetWatch, // q: PROCESS_WS_WATCH_INFORMATION[]; s: void</a>
<a name="ln151">    ProcessUserModeIOPL, // qs: ULONG (requires SeTcbPrivilege)</a>
<a name="ln152">    ProcessEnableAlignmentFaultFixup, // s: BOOLEAN</a>
<a name="ln153">    ProcessPriorityClass, // qs: PROCESS_PRIORITY_CLASS</a>
<a name="ln154">    ProcessWx86Information, // qs: ULONG (requires SeTcbPrivilege) (VdmAllowed)</a>
<a name="ln155">    ProcessHandleCount, // q: ULONG, PROCESS_HANDLE_INFORMATION // 20</a>
<a name="ln156">    ProcessAffinityMask, // s: KAFFINITY</a>
<a name="ln157">    ProcessPriorityBoost, // qs: ULONG</a>
<a name="ln158">    ProcessDeviceMap, // qs: PROCESS_DEVICEMAP_INFORMATION, PROCESS_DEVICEMAP_INFORMATION_EX</a>
<a name="ln159">    ProcessSessionInformation, // q: PROCESS_SESSION_INFORMATION</a>
<a name="ln160">    ProcessForegroundInformation, // s: PROCESS_FOREGROUND_BACKGROUND</a>
<a name="ln161">    ProcessWow64Information, // q: ULONG_PTR</a>
<a name="ln162">    ProcessImageFileName, // q: UNICODE_STRING</a>
<a name="ln163">    ProcessLUIDDeviceMapsEnabled, // q: ULONG</a>
<a name="ln164">    ProcessBreakOnTermination, // qs: ULONG</a>
<a name="ln165">    ProcessDebugObjectHandle, // q: HANDLE // 30</a>
<a name="ln166">    ProcessDebugFlags, // qs: ULONG</a>
<a name="ln167">    ProcessHandleTracing, // q: PROCESS_HANDLE_TRACING_QUERY; s: size 0 disables, otherwise enables</a>
<a name="ln168">    ProcessIoPriority, // qs: IO_PRIORITY_HINT</a>
<a name="ln169">    ProcessExecuteFlags, // qs: ULONG</a>
<a name="ln170">    ProcessResourceManagement, // ProcessTlsInformation // PROCESS_TLS_INFORMATION</a>
<a name="ln171">    ProcessCookie, // q: ULONG</a>
<a name="ln172">    ProcessImageInformation, // q: SECTION_IMAGE_INFORMATION</a>
<a name="ln173">    ProcessCycleTime, // q: PROCESS_CYCLE_TIME_INFORMATION // since VISTA</a>
<a name="ln174">    ProcessPagePriority, // q: PAGE_PRIORITY_INFORMATION</a>
<a name="ln175">    ProcessInstrumentationCallback, // qs: PROCESS_INSTRUMENTATION_CALLBACK_INFORMATION // 40</a>
<a name="ln176">    ProcessThreadStackAllocation, // s: PROCESS_STACK_ALLOCATION_INFORMATION, PROCESS_STACK_ALLOCATION_INFORMATION_EX</a>
<a name="ln177">    ProcessWorkingSetWatchEx, // q: PROCESS_WS_WATCH_INFORMATION_EX[]</a>
<a name="ln178">    ProcessImageFileNameWin32, // q: UNICODE_STRING</a>
<a name="ln179">    ProcessImageFileMapping, // q: HANDLE (input)</a>
<a name="ln180">    ProcessAffinityUpdateMode, // qs: PROCESS_AFFINITY_UPDATE_MODE</a>
<a name="ln181">    ProcessMemoryAllocationMode, // qs: PROCESS_MEMORY_ALLOCATION_MODE</a>
<a name="ln182">    ProcessGroupInformation, // q: USHORT[]</a>
<a name="ln183">    ProcessTokenVirtualizationEnabled, // s: ULONG</a>
<a name="ln184">    ProcessConsoleHostProcess, // q: ULONG_PTR // ProcessOwnerInformation</a>
<a name="ln185">    ProcessWindowInformation, // q: PROCESS_WINDOW_INFORMATION // 50</a>
<a name="ln186">    ProcessHandleInformation, // q: PROCESS_HANDLE_SNAPSHOT_INFORMATION // since WIN8</a>
<a name="ln187">    ProcessMitigationPolicy, // s: PROCESS_MITIGATION_POLICY_INFORMATION</a>
<a name="ln188">    ProcessDynamicFunctionTableInformation,</a>
<a name="ln189">    ProcessHandleCheckingMode, // qs: ULONG; s: 0 disables, otherwise enables</a>
<a name="ln190">    ProcessKeepAliveCount, // q: PROCESS_KEEPALIVE_COUNT_INFORMATION</a>
<a name="ln191">    ProcessRevokeFileHandles, // s: PROCESS_REVOKE_FILE_HANDLES_INFORMATION</a>
<a name="ln192">    ProcessWorkingSetControl, // s: PROCESS_WORKING_SET_CONTROL</a>
<a name="ln193">    ProcessHandleTable, // q: ULONG[] // since WINBLUE</a>
<a name="ln194">    ProcessCheckStackExtentsMode,</a>
<a name="ln195">    ProcessCommandLineInformation, // q: UNICODE_STRING // 60</a>
<a name="ln196">    ProcessProtectionInformation, // q: PS_PROTECTION</a>
<a name="ln197">    ProcessMemoryExhaustion, // PROCESS_MEMORY_EXHAUSTION_INFO // since THRESHOLD</a>
<a name="ln198">    ProcessFaultInformation, // PROCESS_FAULT_INFORMATION</a>
<a name="ln199">    ProcessTelemetryIdInformation, // PROCESS_TELEMETRY_ID_INFORMATION</a>
<a name="ln200">    ProcessCommitReleaseInformation, // PROCESS_COMMIT_RELEASE_INFORMATION</a>
<a name="ln201">    ProcessDefaultCpuSetsInformation,</a>
<a name="ln202">    ProcessAllowedCpuSetsInformation,</a>
<a name="ln203">    ProcessSubsystemProcess,</a>
<a name="ln204">    ProcessJobMemoryInformation, // PROCESS_JOB_MEMORY_INFO</a>
<a name="ln205">    ProcessInPrivate, // since THRESHOLD2 // 70</a>
<a name="ln206">    ProcessRaiseUMExceptionOnInvalidHandleClose, // qs: ULONG; s: 0 disables, otherwise enables</a>
<a name="ln207">    ProcessIumChallengeResponse,</a>
<a name="ln208">    ProcessChildProcessInformation, // PROCESS_CHILD_PROCESS_INFORMATION</a>
<a name="ln209">    ProcessHighGraphicsPriorityInformation,</a>
<a name="ln210">    ProcessSubsystemInformation, // q: SUBSYSTEM_INFORMATION_TYPE // since REDSTONE2</a>
<a name="ln211">    ProcessEnergyValues, // PROCESS_ENERGY_VALUES, PROCESS_EXTENDED_ENERGY_VALUES</a>
<a name="ln212">    ProcessActivityThrottleState, // PROCESS_ACTIVITY_THROTTLE_STATE</a>
<a name="ln213">    ProcessActivityThrottlePolicy, // PROCESS_ACTIVITY_THROTTLE_POLICY</a>
<a name="ln214">    ProcessWin32kSyscallFilterInformation,</a>
<a name="ln215">    ProcessDisableSystemAllowedCpuSets, // 80</a>
<a name="ln216">    ProcessWakeInformation, // PROCESS_WAKE_INFORMATION</a>
<a name="ln217">    ProcessEnergyTrackingState, // PROCESS_ENERGY_TRACKING_STATE</a>
<a name="ln218">    ProcessManageWritesToExecutableMemory, // MANAGE_WRITES_TO_EXECUTABLE_MEMORY // since REDSTONE3</a>
<a name="ln219">    ProcessCaptureTrustletLiveDump,</a>
<a name="ln220">    ProcessTelemetryCoverage,</a>
<a name="ln221">    ProcessEnclaveInformation,</a>
<a name="ln222">    ProcessEnableReadWriteVmLogging, // PROCESS_READWRITEVM_LOGGING_INFORMATION</a>
<a name="ln223">    ProcessUptimeInformation, // PROCESS_UPTIME_INFORMATION</a>
<a name="ln224">    ProcessImageSection, // q: HANDLE</a>
<a name="ln225">    ProcessDebugAuthInformation, // since REDSTONE4 // 90</a>
<a name="ln226">    ProcessSystemResourceManagement, // PROCESS_SYSTEM_RESOURCE_MANAGEMENT</a>
<a name="ln227">    ProcessSequenceNumber, // q: ULONGLONG</a>
<a name="ln228">    ProcessLoaderDetour, // since REDSTONE5</a>
<a name="ln229">    ProcessSecurityDomainInformation, // PROCESS_SECURITY_DOMAIN_INFORMATION</a>
<a name="ln230">    ProcessCombineSecurityDomainsInformation, // PROCESS_COMBINE_SECURITY_DOMAINS_INFORMATION</a>
<a name="ln231">    ProcessEnableLogging, // PROCESS_LOGGING_INFORMATION</a>
<a name="ln232">    ProcessLeapSecondInformation, // PROCESS_LEAP_SECOND_INFORMATION</a>
<a name="ln233">    ProcessFiberShadowStackAllocation, // PROCESS_FIBER_SHADOW_STACK_ALLOCATION_INFORMATION // since 19H1</a>
<a name="ln234">    ProcessFreeFiberShadowStackAllocation, // PROCESS_FREE_FIBER_SHADOW_STACK_ALLOCATION_INFORMATION</a>
<a name="ln235">    ProcessAltSystemCallInformation, // qs: BOOLEAN (kernel-mode only) // since 20H1 // 100</a>
<a name="ln236">    ProcessDynamicEHContinuationTargets, // PROCESS_DYNAMIC_EH_CONTINUATION_TARGETS_INFORMATION</a>
<a name="ln237">    MaxProcessInfoClass</a>
<a name="ln238">} PROCESSINFOCLASS;</a>
<a name="ln239">typedef struct _PROCESS_BASIC_INFORMATION</a>
<a name="ln240">{</a>
<a name="ln241">    NTSTATUS ExitStatus;</a>
<a name="ln242">    _PPEB PebBaseAddress;</a>
<a name="ln243">    ULONG_PTR AffinityMask;</a>
<a name="ln244">    KPRIORITY BasePriority;</a>
<a name="ln245">    HANDLE UniqueProcessId;</a>
<a name="ln246">    HANDLE InheritedFromUniqueProcessId;</a>
<a name="ln247">} PROCESS_BASIC_INFORMATION, * PPROCESS_BASIC_INFORMATION;</a>
<a name="ln248"> </a>
<a name="ln249">typedef enum _SYSTEM_INFORMATION_CLASS {</a>
<a name="ln250">    SystemBasicInformation,</a>
<a name="ln251">    SystemProcessorInformation,</a>
<a name="ln252">    SystemPerformanceInformation,</a>
<a name="ln253">    SystemTimeOfDayInformation,</a>
<a name="ln254">    SystemPathInformation,</a>
<a name="ln255">    SystemProcessInformation,</a>
<a name="ln256">    SystemCallCountInformation,</a>
<a name="ln257">    SystemDeviceInformation,</a>
<a name="ln258">    SystemProcessorPerformanceInformation,</a>
<a name="ln259">    SystemFlagsInformation,</a>
<a name="ln260">    SystemCallTimeInformation,</a>
<a name="ln261">    SystemModuleInformation,</a>
<a name="ln262">    SystemLocksInformation,</a>
<a name="ln263">    SystemStackTraceInformation,</a>
<a name="ln264">    SystemPagedPoolInformation,</a>
<a name="ln265">    SystemNonPagedPoolInformation,</a>
<a name="ln266">    SystemHandleInformation,</a>
<a name="ln267">    SystemObjectInformation,</a>
<a name="ln268">    SystemPageFileInformation,</a>
<a name="ln269">    SystemVdmInstemulInformation,</a>
<a name="ln270">    SystemVdmBopInformation,</a>
<a name="ln271">    SystemFileCacheInformation,</a>
<a name="ln272">    SystemPoolTagInformation,</a>
<a name="ln273">    SystemInterruptInformation,</a>
<a name="ln274">    SystemDpcBehaviorInformation,</a>
<a name="ln275">    SystemFullMemoryInformation,</a>
<a name="ln276">    SystemLoadGdiDriverInformation,</a>
<a name="ln277">    SystemUnloadGdiDriverInformation,</a>
<a name="ln278">    SystemTimeAdjustmentInformation,</a>
<a name="ln279">    SystemSummaryMemoryInformation,</a>
<a name="ln280">    SystemMirrorMemoryInformation,</a>
<a name="ln281">    SystemPerformanceTraceInformation,</a>
<a name="ln282">    SystemObsolete0,</a>
<a name="ln283">    SystemExceptionInformation,</a>
<a name="ln284">    SystemCrashDumpStateInformation,</a>
<a name="ln285">    SystemKernelDebuggerInformation,</a>
<a name="ln286">    SystemContextSwitchInformation,</a>
<a name="ln287">    SystemRegistryQuotaInformation,</a>
<a name="ln288">    SystemExtendServiceTableInformation,</a>
<a name="ln289">    SystemPrioritySeperation,</a>
<a name="ln290">    SystemVerifierAddDriverInformation,</a>
<a name="ln291">    SystemVerifierRemoveDriverInformation,</a>
<a name="ln292">    SystemProcessorIdleInformation,</a>
<a name="ln293">    SystemLegacyDriverInformation,</a>
<a name="ln294">    SystemCurrentTimeZoneInformation,</a>
<a name="ln295">    SystemLookasideInformation,</a>
<a name="ln296">    SystemTimeSlipNotification,</a>
<a name="ln297">    SystemSessionCreate,</a>
<a name="ln298">    SystemSessionDetach,</a>
<a name="ln299">    SystemSessionInformation,</a>
<a name="ln300">    SystemRangeStartInformation,</a>
<a name="ln301">    SystemVerifierInformation,</a>
<a name="ln302">    SystemVerifierThunkExtend,</a>
<a name="ln303">    SystemSessionProcessInformation,</a>
<a name="ln304">    SystemLoadGdiDriverInSystemSpace,</a>
<a name="ln305">    SystemNumaProcessorMap,</a>
<a name="ln306">    SystemPrefetcherInformation,</a>
<a name="ln307">    SystemExtendedProcessInformation,</a>
<a name="ln308">    SystemRecommendedSharedDataAlignment,</a>
<a name="ln309">    SystemComPlusPackage,</a>
<a name="ln310">    SystemNumaAvailableMemory,</a>
<a name="ln311">    SystemProcessorPowerInformation,</a>
<a name="ln312">    SystemEmulationBasicInformation,</a>
<a name="ln313">    SystemEmulationProcessorInformation,</a>
<a name="ln314">    SystemExtendedHandleInformation,</a>
<a name="ln315">    SystemLostDelayedWriteInformation,</a>
<a name="ln316">    SystemBigPoolInformation,</a>
<a name="ln317">    SystemSessionPoolTagInformation,</a>
<a name="ln318">    SystemSessionMappedViewInformation,</a>
<a name="ln319">    SystemHotpatchInformation,</a>
<a name="ln320">    SystemObjectSecurityMode,</a>
<a name="ln321">    SystemWatchdogTimerHandler,</a>
<a name="ln322">    SystemWatchdogTimerInformation,</a>
<a name="ln323">    SystemLogicalProcessorInformation,</a>
<a name="ln324">    SystemWow64SharedInformationObsolete,</a>
<a name="ln325">    SystemRegisterFirmwareTableInformationHandler,</a>
<a name="ln326">    SystemFirmwareTableInformation,</a>
<a name="ln327">    SystemModuleInformationEx,</a>
<a name="ln328">    SystemVerifierTriageInformation,</a>
<a name="ln329">    SystemSuperfetchInformation,</a>
<a name="ln330">    SystemMemoryListInformation,</a>
<a name="ln331">    SystemFileCacheInformationEx,</a>
<a name="ln332">    SystemThreadPriorityClientIdInformation,</a>
<a name="ln333">    SystemProcessorIdleCycleTimeInformation,</a>
<a name="ln334">    SystemVerifierCancellationInformation,</a>
<a name="ln335">    SystemProcessorPowerInformationEx,</a>
<a name="ln336">    SystemRefTraceInformation,</a>
<a name="ln337">    SystemSpecialPoolInformation,</a>
<a name="ln338">    SystemProcessIdInformation,</a>
<a name="ln339">    SystemErrorPortInformation,</a>
<a name="ln340">    SystemBootEnvironmentInformation,</a>
<a name="ln341">    SystemHypervisorInformation,</a>
<a name="ln342">    SystemVerifierInformationEx,</a>
<a name="ln343">    SystemTimeZoneInformation,</a>
<a name="ln344">    SystemImageFileExecutionOptionsInformation,</a>
<a name="ln345">    SystemCoverageInformation,</a>
<a name="ln346">    SystemPrefetchPatchInformation,</a>
<a name="ln347">    SystemVerifierFaultsInformation,</a>
<a name="ln348">    SystemSystemPartitionInformation,</a>
<a name="ln349">    SystemSystemDiskInformation,</a>
<a name="ln350">    SystemProcessorPerformanceDistribution,</a>
<a name="ln351">    SystemNumaProximityNodeInformation,</a>
<a name="ln352">    SystemDynamicTimeZoneInformation,</a>
<a name="ln353">    SystemCodeIntegrityInformation,</a>
<a name="ln354">    SystemProcessorMicrocodeUpdateInformation,</a>
<a name="ln355">    SystemProcessorBrandString,</a>
<a name="ln356">    SystemVirtualAddressInformation,</a>
<a name="ln357">    SystemLogicalProcessorAndGroupInformation,</a>
<a name="ln358">        SystemProcessorCycleTimeInformation,</a>
<a name="ln359">        SystemStoreInformation,</a>
<a name="ln360">        SystemRegistryAppendString,</a>
<a name="ln361">        SystemAitSamplingValue,</a>
<a name="ln362">        SystemVhdBootInformation,</a>
<a name="ln363">        SystemCpuQuotaInformation,</a>
<a name="ln364">        SystemNativeBasicInformation,</a>
<a name="ln365">        SystemErrorPortTimeouts,</a>
<a name="ln366">        SystemLowPriorityIoInformation,</a>
<a name="ln367">        SystemBootEntropyInformation,</a>
<a name="ln368">        SystemVerifierCountersInformation,</a>
<a name="ln369">        SystemPagedPoolInformationEx,</a>
<a name="ln370">        SystemSystemPtesInformationEx,</a>
<a name="ln371">        SystemNodeDistanceInformation,</a>
<a name="ln372">        SystemAcpiAuditInformation,</a>
<a name="ln373">        SystemBasicPerformanceInformation,</a>
<a name="ln374">        SystemQueryPerformanceCounterInformation,</a>
<a name="ln375">        SystemSessionBigPoolInformation,</a>
<a name="ln376">        SystemBootGraphicsInformation,</a>
<a name="ln377">        SystemScrubPhysicalMemoryInformation,</a>
<a name="ln378">        SystemBadPageInformation,</a>
<a name="ln379">        SystemProcessorProfileControlArea,</a>
<a name="ln380">        SystemCombinePhysicalMemoryInformation,</a>
<a name="ln381">        SystemEntropyInterruptTimingInformation,</a>
<a name="ln382">        SystemConsoleInformation,</a>
<a name="ln383">        SystemPlatformBinaryInformation,</a>
<a name="ln384">        SystemPolicyInformation,</a>
<a name="ln385">        SystemHypervisorProcessorCountInformation,</a>
<a name="ln386">        SystemDeviceDataInformation,</a>
<a name="ln387">        SystemDeviceDataEnumerationInformation,</a>
<a name="ln388">        SystemMemoryTopologyInformation,</a>
<a name="ln389">        SystemMemoryChannelInformation,</a>
<a name="ln390">        SystemBootLogoInformation,</a>
<a name="ln391">        SystemProcessorPerformanceInformationEx,</a>
<a name="ln392">        SystemCriticalProcessErrorLogInformation,</a>
<a name="ln393">        SystemSecureBootPolicyInformation,</a>
<a name="ln394">        SystemPageFileInformationEx,</a>
<a name="ln395">        SystemSecureBootInformation,</a>
<a name="ln396">        SystemEntropyInterruptTimingRawInformation,</a>
<a name="ln397">        SystemPortableWorkspaceEfiLauncherInformation,</a>
<a name="ln398">        SystemFullProcessInformation,</a>
<a name="ln399">        SystemKernelDebuggerInformationEx,</a>
<a name="ln400">        SystemBootMetadataInformation,</a>
<a name="ln401">        SystemSoftRebootInformation,</a>
<a name="ln402">        SystemElamCertificateInformation,</a>
<a name="ln403">        SystemOfflineDumpConfigInformation,</a>
<a name="ln404">        SystemProcessorFeaturesInformation,</a>
<a name="ln405">        SystemRegistryReconciliationInformation,</a>
<a name="ln406">        SystemEdidInformation,</a>
<a name="ln407">        SystemManufacturingInformation,</a>
<a name="ln408">        SystemEnergyEstimationConfigInformation,</a>
<a name="ln409">        SystemHypervisorDetailInformation,</a>
<a name="ln410">        SystemProcessorCycleStatsInformation,</a>
<a name="ln411">        SystemVmGenerationCountInformation,</a>
<a name="ln412">        SystemTrustedPlatformModuleInformation,</a>
<a name="ln413">        SystemKernelDebuggerFlags,</a>
<a name="ln414">        SystemCodeIntegrityPolicyInformation,</a>
<a name="ln415">        SystemIsolatedUserModeInformation,</a>
<a name="ln416">        SystemHardwareSecurityTestInterfaceResultsInformation,</a>
<a name="ln417">        SystemSingleModuleInformation,</a>
<a name="ln418">        SystemAllowedCpuSetsInformation,</a>
<a name="ln419">        SystemDmaProtectionInformation,</a>
<a name="ln420">        SystemInterruptCpuSetsInformation,</a>
<a name="ln421">        SystemSecureBootPolicyFullInformation,</a>
<a name="ln422">        SystemCodeIntegrityPolicyFullInformation,</a>
<a name="ln423">        SystemAffinitizedInterruptProcessorInformation,</a>
<a name="ln424">        SystemRootSiloInformation,</a>
<a name="ln425">        SystemCpuSetInformation,</a>
<a name="ln426">        SystemCpuSetTagInformation,</a>
<a name="ln427">        SystemWin32WerStartCallout,</a>
<a name="ln428">        SystemSecureKernelProfileInformation,</a>
<a name="ln429">        SystemCodeIntegrityPlatformManifestInformation,</a>
<a name="ln430">        SystemInterruptSteeringInformation,</a>
<a name="ln431">        SystemSuppportedProcessorArchitectures,</a>
<a name="ln432">        SystemMemoryUsageInformation,</a>
<a name="ln433">        SystemCodeIntegrityCertificateInformation,</a>
<a name="ln434">        SystemPhysicalMemoryInformation,</a>
<a name="ln435">        SystemControlFlowTransition,</a>
<a name="ln436">        SystemKernelDebuggingAllowed,</a>
<a name="ln437">        SystemActivityModerationExeState,</a>
<a name="ln438">        SystemActivityModerationUserSettings,</a>
<a name="ln439">        SystemCodeIntegrityPoliciesFullInformation,</a>
<a name="ln440">        SystemCodeIntegrityUnlockInformation,</a>
<a name="ln441">        SystemIntegrityQuotaInformation,</a>
<a name="ln442">        SystemFlushInformation,</a>
<a name="ln443">        SystemProcessorIdleMaskInformation,</a>
<a name="ln444">        SystemSecureDumpEncryptionInformation,</a>
<a name="ln445">        SystemWriteConstraintInformation,</a>
<a name="ln446">        SystemKernelVaShadowInformation,</a>
<a name="ln447">        SystemHypervisorSharedPageInformation,</a>
<a name="ln448">        SystemFirmwareBootPerformanceInformation,</a>
<a name="ln449">        SystemCodeIntegrityVerificationInformation,</a>
<a name="ln450">        SystemFirmwarePartitionInformation,</a>
<a name="ln451">        SystemSpeculationControlInformation,</a>
<a name="ln452">        SystemDmaGuardPolicyInformation,</a>
<a name="ln453">        SystemEnclaveLaunchControlInformation,</a>
<a name="ln454">        MaxSystemInfoClass</a>
<a name="ln455">} SYSTEM_INFORMATION_CLASS, * PSYSTEM_INFORMATION_CLASS;</a>
<a name="ln456"> </a>
<a name="ln457">typedef struct _SYSTEM_BASIC_INFORMATION // 11 elements, x32: 0x2C, x86_64: 0x40</a>
<a name="ln458">{</a>
<a name="ln459">    ULONG Reserved;</a>
<a name="ln460">    ULONG TimerResolution;</a>
<a name="ln461">    ULONG PageSize;</a>
<a name="ln462">    ULONG NumberOfPhysicalPages;</a>
<a name="ln463">    ULONG LowestPhysicalPageNumber;</a>
<a name="ln464">    ULONG HighestPhysicalPageNumber;</a>
<a name="ln465">    ULONG AllocationGranularity;</a>
<a name="ln466">    ULONG_PTR MinimumUserModeAddress;</a>
<a name="ln467">    ULONG_PTR MaximumUserModeAddress;</a>
<a name="ln468">    KAFFINITY ActiveProcessorsAffinityMask;</a>
<a name="ln469">    CHAR NumberOfProcessors;</a>
<a name="ln470">} SYSTEM_BASIC_INFORMATION, * PSYSTEM_BASIC_INFORMATION;</a>
<a name="ln471"> </a>
<a name="ln472">// Function Prototypes (NOTE: SYSCALLS ARE FOR WIN10 x86_64 BUILD 2004)</a>
<a name="ln473">EXTERN_C NTSTATUS NtUnmapViewOfSection(</a>
<a name="ln474">    HANDLE              ProcessHandle,</a>
<a name="ln475">    PVOID               BaseAddress</a>
<a name="ln476">);</a>
<a name="ln477">EXTERN_C NTSTATUS NtQueryInformationProcess(</a>
<a name="ln478">    HANDLE              ProcessHandle,</a>
<a name="ln479">    PROCESSINFOCLASS    ProcessInformationClass,</a>
<a name="ln480">    PVOID               ProcessInformation,</a>
<a name="ln481">    ULONG               ProcessInformationLength,</a>
<a name="ln482">    PULONG              ReturnLength</a>
<a name="ln483">);</a>
<a name="ln484">EXTERN_C NTSTATUS NtSuspendProcess(</a>
<a name="ln485">    HANDLE              ProcessHandle</a>
<a name="ln486">);</a>
<a name="ln487">EXTERN_C NTSTATUS NtReadVirtualMemory(</a>
<a name="ln488">    HANDLE              ProcessHandle,</a>
<a name="ln489">    PVOID               BaseAddress,</a>
<a name="ln490">    PVOID               Buffer,</a>
<a name="ln491">    ULONG               NumberOfBytesToRead,</a>
<a name="ln492">    PULONG              NumberOfBytesReaded</a>
<a name="ln493">);</a>
<a name="ln494">EXTERN_C NTSTATUS NtWriteVirtualMemory(</a>
<a name="ln495">    HANDLE              ProcessHandle,</a>
<a name="ln496">    PVOID               BaseAddress,</a>
<a name="ln497">    PVOID               Buffer,</a>
<a name="ln498">    ULONG               NumberOfBytesToWrite,</a>
<a name="ln499">    PULONG              NumberOfBytesWritten</a>
<a name="ln500">);</a>
<a name="ln501">EXTERN_C NTSTATUS NtAllocateVirtualMemory(</a>
<a name="ln502">    HANDLE              ProcessHandle,</a>
<a name="ln503">    PVOID*              BaseAddress,</a>
<a name="ln504">    ULONG_PTR           ZeroBits,</a>
<a name="ln505">    PSIZE_T             RegionSize,</a>
<a name="ln506">    ULONG               AllocationType,</a>
<a name="ln507">    ULONG               Protect</a>
<a name="ln508">);</a>
<a name="ln509">EXTERN_C NTSTATUS NtFreeVirtualMemory(</a>
<a name="ln510">    HANDLE              ProcessHandle,</a>
<a name="ln511">    PVOID*              BaseAddress,</a>
<a name="ln512">    PULONG              RegionSize,</a>
<a name="ln513">    ULONG               FreeType</a>
<a name="ln514">);</a>
<a name="ln515">EXTERN_C NTSTATUS NtProtectVirtualMemory(</a>
<a name="ln516">    HANDLE              ProcessHandle,</a>
<a name="ln517">    PVOID*              BaseAddress,</a>
<a name="ln518">    PULONG              NumberOfBytesToProtect,</a>
<a name="ln519">    ULONG               NewAccessProtection,</a>
<a name="ln520">    PULONG              OldAccessProtection</a>
<a name="ln521">);</a>
<a name="ln522">EXTERN_C NTSTATUS NtQuerySystemInformation(</a>
<a name="ln523">    SYSTEM_INFORMATION_CLASS SystemInformationClass,</a>
<a name="ln524">    PVOID                    SystemInformation,</a>
<a name="ln525">    ULONG                    SystemInformationLength,</a>
<a name="ln526">    PULONG                   ReturnLength</a>
<a name="ln527">);</a>

</code></pre>
<div class="balloon" rel="458"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v802/" target="_blank">V802</a> On 64-bit platform, structure size can be reduced from 64 to 56 bytes by rearranging the fields according to their sizes in decreasing order.</p></div>
<div class="balloon" rel="240"><p><span style="font-size:18px">&uarr;</span> <a href="https://www.viva64.com/en/w/v802/" target="_blank">V802</a> On 64-bit platform, structure size can be reduced from 48 to 40 bytes by rearranging the fields according to their sizes in decreasing order.</p></div>

<link rel="stylesheet" href="highlight.css">
<script src="highlight.pack.js"></script>
<script src="highlightjs-line-numbers.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>hljs.initLineNumbersOnLoad();</script>
<script>
  $(document).ready(function() {
      $('.balloon').each(function () {
          var bl = $(this);
          var line = bl.attr('rel');
          var text = $('a[name="ln'+line+'"]').text();

          var space_count = 0;
          for(var i = 0; i<text.length; i++){
              var char = text[i];
              if((char !== ' ')&&(char !== '\t'))break;
              if(char === '\t')space_count++;
              space_count++;
          }

          bl.css('margin-left', space_count*8);
          $('a[name="ln'+line+'"]').after(bl);
      });

      window.location = window.location;
  });
</script>
</body>
</html>
